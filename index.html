<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="icon" href="logo-sem-fundo.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrazyDog - Cardápio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --bg-dark: #23272f;
            --primary-orange: #f48c2e;
            --primary-green: #a3e635;
        }
        body { background-color: var(--bg-dark); color: white; }
        .card-shadow { shadow-[0_20px_50px_rgba(0,0,0,0.5)] }
    </style>
</head>
<body class="font-sans">

    <header class="p-6 flex flex-col items-center">
        <img src="logo.jpeg" alt="CrazyDog Logo" class="h-24 object-contain mb-4">
        <div class="flex gap-2">
            <span class="bg-[#a3e635] text-black text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-tighter">Aberto Agora</span>
            <a href="login.html" class="bg-gray-800 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-tighter hover:bg-gray-700 transition-all">Painel Admin</a>
        </div>
    </header>

    <section class="px-6 mb-10">
        <div class="relative h-48 rounded-3xl overflow-hidden border border-gray-800">
            <img src="banner.jpg" alt="Promoção" class="w-full h-full object-cover opacity-60">
            <div class="absolute inset-0 flex flex-col justify-center p-8 bg-gradient-to-r from-[#23272f] to-transparent">
                <h2 class="text-3xl font-black uppercase italic leading-none">Combo<br><span class="text-[#f48c2e]">Crazy</span></h2>
                <p class="text-xs text-gray-400 mt-2 uppercase font-bold tracking-widest">A partir de R$ 29,90</p>
            </div>
        </div>
    </section>

    <main class="px-6 pb-24">
        <h3 class="text-[#a3e635] font-black uppercase italic tracking-widest mb-6 flex items-center gap-2">
            <i data-lucide="flame" class="w-5 h-5"></i> Nossos Lanches
        </h3>

        <div id="cardapio-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <p class="text-gray-500 text-sm italic">Carregando cardápio...</p>
        </div>
    </main>

    <script>
        // 1. Configuração do Supabase
        const supabaseUrl = 'https://fxmivhmbilnfkxusaxid.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ4bWl2aG1iaWxuZmt4dXNheGlkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4OTE1MjcsImV4cCI6MjA4NzQ2NzUyN30.dslzpVwwI3Kua52dS1JpD5SrbkSNm68dED7nToLw2nM';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        let LANCHES = [];

        // 2. Buscar lanches diretamente do Supabase
        async function buscarLanchesDoBanco() {
            const { data, error } = await supabaseClient
                .from('lanches')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) {
                console.error("Erro ao buscar lanches:", error.message);
                document.getElementById('cardapio-grid').innerHTML = `<p class="text-red-500 text-xs">Erro ao carregar cardápio. Verifique a conexão.</p>`;
            } else {
                LANCHES = data;
                renderizarCardapio();
            }
        }

        // 3. Renderizar o HTML na tela
        function renderizarCardapio() {
            const grid = document.getElementById('cardapio-grid');
            
            if (LANCHES.length === 0) {
                grid.innerHTML = `<p class="text-gray-500 text-sm italic">Nenhum lanche cadastrado no momento.</p>`;
                return;
            }

            grid.innerHTML = LANCHES.map(item => `
                <div class="bg-[#2d3139] rounded-3xl overflow-hidden border border-gray-800 flex flex-col shadow-xl">
                    <div class="h-48 overflow-hidden relative">
                        <img src="${item.imagem}" class="w-full h-full object-cover">
                        <div class="absolute top-4 right-4 bg-[#f48c2e] text-white font-black px-3 py-1 rounded-full text-xs">
                            R$ ${parseFloat(item.preco).toFixed(2)}
                        </div>
                    </div>
                    <div class="p-6">
                        <h4 class="text-lg font-black uppercase italic">${item.nome}</h4>
                        <p class="text-gray-400 text-xs mt-2 mb-4 leading-tight">${item.descricao || 'Sem descrição.'}</p>
                        
                        <button onclick="pedirWhatsApp('${item.nome}')" class="w-full py-3 bg-[#a3e635] text-[#1a1d23] font-black uppercase text-xs rounded-xl hover:scale-95 transition-all flex items-center justify-center gap-2">
                            <i data-lucide="shopping-cart" class="w-4 h-4"></i> Pedir Agora
                        </button>
                    </div>
                </div>
            `).join('');
            
            lucide.createIcons();
        }

        function pedirWhatsApp(nomeLanche) {
            const mensagem = `Olá! Gostaria de pedir o lanche: ${nomeLanche}`;
            const link = `https://wa.me/5515999999999?text=${encodeURIComponent(mensagem)}`; // Substitua pelo seu número
            window.open(link, '_blank');
        }

        // 4. Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            buscarLanchesDoBanco();
            lucide.createIcons();
        });
    </script>
</body>
</html>